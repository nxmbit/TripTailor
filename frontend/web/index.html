<!DOCTYPE html>
<html>
  <head>
    <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
    <base href="$FLUTTER_BASE_HREF" />

    <meta charset="UTF-8" />
    <meta content="IE=Edge" http-equiv="X-UA-Compatible" />
    <meta name="description" content="TripTailor app frontend." />

    <!-- iOS meta tags & icons -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="frontend" />
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">

    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" sizes="any">

    <title>Trip Tailor</title>
    <link rel="manifest" href="manifest.json" />
    <style>
      /* Disable browser's default tap highlight */
      * {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      /* Re-enable selection for text input fields */
      input,
      textarea {
        -webkit-user-select: text;
        -khtml-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
        user-select: text;
      }
    </style>
  </head>
  <body>
    <script src="flutter_bootstrap.js" async></script>
    <script>
      // This will be updated from Flutter with the actual key from .env
      window.googleMapsApiKey = "";

      // Create a function to initialize the map API
      function loadGoogleMapsApi() {
        if (window.googleMapsApiKey) {
          // Get the current language from Flutter or use a default
          const language = window.mapLanguage || "en";

          const script = document.createElement("script");
          script.src = `https://maps.googleapis.com/maps/api/js?key=${window.googleMapsApiKey}&language=${language}`;
          script.async = true;
          script.defer = true;
          document.head.appendChild(script);
        } else {
          // Wait until Flutter sets the API key
          setTimeout(loadGoogleMapsApi, 100);
        }
      }

      window.addEventListener("load", function () {
        loadGoogleMapsApi();
      });
    </script>
  </body>
</html>
